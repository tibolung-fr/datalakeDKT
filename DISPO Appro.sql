
SELECT *, 
        (case when appro = 'CAC' and q_cac_rouge < q_dispo_cac then q_dispo_cac-q_cac_rouge 
        when appro = 'CAR' and q_car_rouge < q_dispo_car then q_dispo_car - q_car_rouge
        else 0 end) as DISPO  
FROM ods_supply.zsc_photo2 stock
WHERE stock.car = 'W016'
AND stock.date_crea BETWEEN '01.04.2021' AND '01.04.2021'
AND stock.matnr in ('000000000002730429'
/*'000000000004054213',
'000000000004054212',
'000000000002925689',
'000000000002661602',
'000000000002665235',
'000000000002378968',
'000000000002379046',
'000000000002665226',
'000000000002665236',
'000000000002665227',
'000000000002379045',
'000000000002379048',
'000000000002379047',
'000000000002665239',
'000000000002665237',
'000000000002471310',
'000000000002685538',
'000000000002471312',
'000000000002472197',
'000000000002471311',
'000000000002962864',
'000000000002693720',
'000000000002424190',
'000000000002961848',
'000000000002961849',
'000000000002962860',
'000000000002471309',
'000000000002962863',
'000000000002685537',
'000000000002499494',
'000000000002499493',
'000000000002472191',
'000000000002496977',
'000000000002424191',
'000000000002472188',
'000000000002496979',
'000000000002693722',
'000000000002643818',
'000000000002693721',
'000000000002685539',
'000000000002424189',
'000000000002962862',
'000000000002424193',
'000000000002424192',
'000000000002961847',
'000000000002685541',
'000000000002472198',
'000000000002471186',
'000000000002496978',
'000000000002643816',
'000000000002693718',
'000000000002633429',
'000000000002633428',
'000000000002499491',
'000000000004046116',
'000000000004046114',
'000000000004046115',
'000000000002488393',
'000000000002391250',
'000000000002697415',
'000000000004000392',
'000000000002696198',
'000000000002488394',
'000000000002488391',
'000000000002697413',
'000000000002488392',
'000000000002841164',
'000000000004152816',
'000000000002938864',
'000000000002938930',
'000000000002524939',
'000000000002471880',
'000000000002531586',
'000000000002180408',
'000000000002379507',
'000000000002391691',
'000000000002391694',
'000000000002391692',
'000000000002379506',
'000000000002734145',
'000000000002734143',
'000000000002734144',
'000000000000695497',
'000000000002015169',
'000000000002415282',
'000000000004054215',
'000000000002900871',
'000000000002900870',
'000000000002900869',
'000000000002900868',
'000000000002837615',
'000000000002458199',
'000000000002458198',
'000000000002575677',
'000000000002575424',
'000000000002575425',
'000000000002917592',
'000000000002575352',
'000000000002575351',
'000000000002925690',
'000000000002721124',
'000000000002711060',
'000000000002491923',
'000000000002524940',
'000000000002524482',
'000000000002524481',
'000000000002524420',
'000000000002524419',
'000000000002402003',
'000000000002365171',
'000000000002364931',
'000000000002364930',
'000000000002068041',
'000000000002017323',
'000000000002017322',
'000000000002017320',
'000000000002017319',
'000000000002017318',
'000000000002013939',
'000000000002013938',
'000000000002013937',
'000000000000712811',
'000000000000712792',
'000000000000712790',
'000000000000712785',
'000000000000712781',
'000000000001749020',
'000000000002428271'*/
)
